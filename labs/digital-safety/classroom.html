<!DOCTYPE html>
<html lang="en" data-bs-theme="light">

    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Digital Safety Classroom | Vidya Parmar, dmj.one</title>
        <!-- Bootstrap 5.3 from cdnjs -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/css/bootstrap.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <style>
            /* Minimal custom CSS */
            .mono {
                font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
            }

            .large-btn .btn {
                min-width: 160px;
                font-size: 1.05rem;
            }

            .vh-25 {
                height: 25vh;
            }

            .scroll {
                overflow: auto;
            }

            .badge-dot {
                display: inline-block;
                width: 10px;
                height: 10px;
                border-radius: 50%;
                margin-right: 6px;
            }

            .dot-on {
                background: #16a34a;
            }

            .dot-off {
                background: #dc3545;
            }
        </style>
    </head>

    <body>
        <nav class="navbar navbar-expand-lg bg-body-tertiary border-bottom">
            <div class="container-fluid">
                <span class="navbar-brand fw-semibold">Digital Safety Classroom - By Vidya Parmar</span>
                <div class="d-flex gap-2">
                    <button id="langToggle" class="btn btn-outline-secondary btn-sm" type="button">हिंदी</button>
                    <button id="resetBtn" class="btn btn-outline-danger btn-sm" type="button">Reset Demo</button>
                </div>
            </div>
        </nav>

        <main class="container py-4">
            <div class="row g-3">
                <div class="col-12">
                    <div class="alert alert-info mb-0" role="alert">
                        <strong>Show, don’t tell:</strong> This single HTML file simulates cookies/consent, email subscriptions, phone-for-discounts, data sharing, and how that information can fuel scam attempts —
                        <em>without sending any data to the internet</em>. Everything is stored locally in your browser (localStorage / sessionStorage).
                    </div>
                </div>

                <!-- 0) Participant basics -->
                <section class="col-12">
                    <div class="card">
                        <div class="card-header fw-semibold" data-i18n="sec_participant">Participant (demo identity)</div>
                        <div class="card-body">
                            <form id="whoForm" class="row gy-3">
                                <div class="col-md-4">
                                    <label class="form-label" data-i18n="label_name">Name</label>
                                    <input class="form-control" id="name" placeholder="Ravi / Seema" />
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label" data-i18n="label_email">Email</label>
                                    <input class="form-control" id="email" type="email" placeholder="you@example.com" />
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label" data-i18n="label_phone">Phone</label>
                                    <input class="form-control" id="phone" placeholder="99999-99999" />
                                </div>
                                <div class="col-12 d-flex flex-wrap gap-2">
                                    <button class="btn btn-primary" type="submit" data-i18n="btn_save">Save</button>
                                    <span class="text-muted align-self-center" id="whoSaved"></span>
                                </div>
                            </form>
                        </div>
                    </div>
                </section>

                <!-- 1) Cookie / Consent simulator -->
                <section class="col-12">
                    <div class="card">
                        <div class="card-header fw-semibold" data-i18n="sec_cookies">Cookies & Consent</div>
                        <div class="card-body">
                            <div class="row g-3 align-items-center">
                                <div class="col-lg-6">
                                    <div class="large-btn d-flex flex-wrap gap-2">
                                        <button class="btn btn-dark" id="acceptAll" type="button" data-i18n="btn_accept_all">Accept All</button>
                                        <button class="btn btn-outline-secondary" id="rejectAll" type="button" data-i18n="btn_reject_all">Reject All</button>
                                        <button class="btn btn-outline-primary" id="customize" type="button" data-i18n="btn_customize">Customize</button>
                                    </div>
                                    <div class="mt-3 small">
                                        <div class="d-flex align-items-center gap-2">
                                            <span class="badge-dot" id="trackDot"></span>
                                            <span id="trackerStatus">Tracker: OFF</span>
                                        </div>
                                        <div class="text-muted" id="consentSummary"></div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="card mb-0">
                                        <div class="card-body p-2">
                                            <div class="row g-2">
                                                <div class="col-6 small"><span class="text-muted">UA:</span> <span class="mono" id="ua"></span></div>
                                                <div class="col-6 small"><span class="text-muted">Lang:</span> <span class="mono" id="lang"></span></div>
                                                <div class="col-6 small"><span class="text-muted">TZ:</span> <span class="mono" id="tz"></span></div>
                                                <div class="col-6 small"><span class="text-muted">Session ID:</span> <span class="mono" id="sid"></span></div>
                                            </div>
                                            <div class="small mt-2 text-muted">(IP would also be captured online; this offline demo does not contact the internet.)</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 2) Email subscription demo -->
                <section class="col-12">
                    <div class="card">
                        <div class="card-header fw-semibold" data-i18n="sec_email">Email Subscription</div>
                        <div class="card-body">
                            <form id="subForm" class="row gy-2 align-items-end">
                                <div class="col-md-4">
                                    <label class="form-label" data-i18n="label_email">Email</label>
                                    <input class="form-control" id="subEmail" type="email" placeholder="you@example.com" />
                                </div>
                                <div class="col-md-4">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="offers" checked />
                                        <label class="form-check-label" for="offers" data-i18n="label_offers">Send me offers & updates</label>
                                    </div>
                                    <div class="form-text" data-i18n="hint_unsub">Unsubscribe any time.</div>
                                </div>
                                <div class="col-md-4 d-flex gap-2">
                                    <button class="btn btn-primary" type="submit" data-i18n="btn_subscribe">Subscribe</button>
                                    <button class="btn btn-outline-secondary" id="btnUnsub" type="button" data-i18n="btn_unsubscribe">Unsubscribe</button>
                                </div>
                            </form>

                            <div class="row mt-3">
                                <div class="col-lg-6">
                                    <div class="card">
                                        <div class="card-header p-2 small">Local Inbox (demo)</div>
                                        <div class="card-body p-2 vh-25 scroll">
                                            <table class="table table-sm align-middle mb-0">
                                                <thead>
                                                    <tr class="small">
                                                        <th>Time</th>
                                                        <th>To</th>
                                                        <th>Subject</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="inboxT"></tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="card">
                                        <div class="card-header p-2 small">What gets logged</div>
                                        <div class="card-body p-2 vh-25 scroll">
                                            <table class="table table-sm align-middle mb-0">
                                                <thead>
                                                    <tr class="small">
                                                        <th>Time</th>
                                                        <th>Event</th>
                                                        <th>Details</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="emailLogT"></tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 3) Phone-for-discount demo -->
                <section class="col-12">
                    <div class="card">
                        <div class="card-header fw-semibold" data-i18n="sec_phone">Phone Number for Discount</div>
                        <div class="card-body">
                            <form id="phoneForm" class="row gy-2 align-items-end">
                                <div class="col-md-4">
                                    <label class="form-label" data-i18n="label_phone">Phone</label>
                                    <input class="form-control" id="phoneInput" placeholder="99999-99999" />
                                </div>
                                <div class="col-md-4">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="sms" checked />
                                        <label class="form-check-label" for="sms" data-i18n="label_sms">Receive SMS/WhatsApp offers</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="ebill" />
                                        <label class="form-check-label" for="ebill" data-i18n="label_ebill">Get e-bills on SMS/WhatsApp</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="partners" />
                                        <label class="form-check-label" for="partners" data-i18n="label_partners">Allow sharing with "partners"</label>
                                    </div>
                                </div>
                                <div class="col-md-4 d-flex gap-2">
                                    <button class="btn btn-success" type="submit" data-i18n="btn_get_off">Get ₹50 off</button>
                                    <button class="btn btn-outline-secondary" id="btnLeak" type="button" data-i18n="btn_sim_leak">Simulate Partner Leak</button>
                                </div>
                            </form>

                            <div class="row mt-3">
                                <div class="col-lg-6">
                                    <div class="card">
                                        <div class="card-header p-2 small">Leak Feed (simulated)</div>
                                        <div class="card-body p-2 vh-25 scroll">
                                            <table class="table table-sm mb-0">
                                                <thead>
                                                    <tr class="small">
                                                        <th>Time</th>
                                                        <th>Channel</th>
                                                        <th>Data</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="leakT"></tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="card">
                                        <div class="card-header p-2 small">Live Logs</div>
                                        <div class="card-body p-2 vh-25 scroll">
                                            <table class="table table-sm mb-0">
                                                <thead>
                                                    <tr class="small">
                                                        <th>Time</th>
                                                        <th>Event</th>
                                                        <th>Details</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="phoneLogT"></tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 4) Scam simulator / consequences -->
                <section class="col-12">
                    <div class="card">
                        <div class="card-header fw-semibold" data-i18n="sec_scam">Scam Scenarios (based on your data)</div>
                        <div class="card-body">
                            <div class="d-flex flex-wrap gap-2 mb-2">
                                <button id="btnScam" class="btn btn-warning" type="button" data-i18n="btn_run_scam">Simulate Likely Scams</button>
                                <button id="btnExport" class="btn btn-outline-secondary" type="button" data-i18n="btn_export">Export Evidence (JSON)</button>
                            </div>
                            <div class="row g-3">
                                <div class="col-lg-6">
                                    <div class="card border-warning">
                                        <div class="card-header p-2 small">Predicted Attacks</div>
                                        <div class="card-body p-2 vh-25 scroll">
                                            <ul id="scamList" class="mb-0"></ul>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="card border-success">
                                        <div class="card-header p-2 small">How to Protect</div>
                                        <div class="card-body p-2">
                                            <ul class="mb-2">
                                                <li>Use a separate email for shopping/discounts.</li>
                                                <li>Never share OTP or install remote-control apps for “refund/KYC”.</li>
                                                <li>Don’t tick “share with partners”. Limit consent to necessary only.</li>
                                                <li>Unsubscribe and block spam. Register DND with your carrier.</li>
                                                <li>If money is taken fraudulently, call <strong>1930</strong> quickly to try freezing the transfer.</li>
                                            </ul>
                                            <div class="text-muted small">This is an educational simulation. No data leaves your browser.</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 5) Global event stream -->
                <section class="col-12">
                    <div class="card">
                        <div class="card-header fw-semibold">Full Event Stream</div>
                        <div class="card-body p-2 vh-25 scroll">
                            <table class="table table-sm align-middle mb-0">
                                <thead>
                                    <tr class="small">
                                        <th>Time</th>
                                        <th>Type</th>
                                        <th>Payload</th>
                                    </tr>
                                </thead>
                                <tbody id="eventT"></tbody>
                            </table>
                        </div>
                    </div>
                </section>
            </div>
        </main>

        <footer class="border-top py-3 text-center small text-muted">
            Digital Safety Classroom — static demo • Stores data under <span class="mono">localStorage["DSC_V1"]</span>
        </footer>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/js/bootstrap.bundle.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script>
            // ======= Minimal, offline, static demo logic =======
            // BEFORE: const KEY = 'DSC_V1';
            const SLUG = (location.pathname.split('/').filter(Boolean).pop() || 'classroom')
                .replace(/[^a-z0-9-]/gi, '_')
                .toLowerCase();
            const KEY = `DSL_${SLUG}_V1`;

            const DEFAULT = () => ({
                version: '1.0.0',
                sessionId: 'dsc-' + Math.random().toString(36).slice(2, 10),
                user: { name: '', email: '', phone: '' },
                consent: { necessary: true, preferences: true, marketing: false },
                tracker: { on: false },
                inbox: [], // {ts,to,subject,body}
                events: [], // {ts,type,payload}
                leaks: [],  // {ts,channel,data}
                scams: []   // strings
            });

            let state = load();
            let trackerTimer = null;

            function load() {
                try { return JSON.parse(localStorage.getItem(KEY)) || DEFAULT(); }
                catch (e) { return DEFAULT(); }
            }
            function save() { localStorage.setItem(KEY, JSON.stringify(state)); }
            function now() { return new Date().toISOString(); }

            function addEvent(type, payload) {
                state.events.unshift({ ts: now(), type, payload });
                save();
                renderEvents();
            }
            function addLeak(channel, data) {
                state.leaks.unshift({ ts: now(), channel, data });
                addEvent('leak', { channel, data });
                renderLeaks();
            }

            // ===== Consent / Tracker =====
            function startTracker() {
                if (trackerTimer) clearInterval(trackerTimer);
                trackerTimer = setInterval(() => {
                    if (state.consent.marketing) {
                        const ping = { ua: navigator.userAgent, lang: navigator.language, tz: Intl.DateTimeFormat().resolvedOptions().timeZone, sid: state.sessionId, e: 'heartbeat', t: Date.now() };
                        addEvent('tracker_ping', ping);
                    }
                }, 5000);
                state.tracker.on = true; save(); updateTrackerUI();
            }
            function stopTracker() { if (trackerTimer) clearInterval(trackerTimer); state.tracker.on = false; save(); updateTrackerUI(); }

            function acceptAll() { state.consent = { necessary: true, preferences: true, marketing: true }; save(); addEvent('consent', 'accept_all'); startTracker(); updateConsentSummary(); alert('Accepted all — tracker will start pings (watch logs).'); }
            function rejectAll() { state.consent = { necessary: true, preferences: false, marketing: false }; save(); addEvent('consent', 'reject_all'); stopTracker(); updateConsentSummary(); alert('Rejected all — tracker off.'); }
            function customize() { const on = confirm('Enable marketing/ads tracking?\nOK = Yes, Cancel = No'); state.consent.marketing = !!on; save(); addEvent('consent', { marketing: state.consent.marketing }); if (on) startTracker(); else stopTracker(); updateConsentSummary(); }

            function updateConsentSummary() {
                const s = state.consent;
                document.getElementById('consentSummary').textContent = `necessary:${s.necessary ? 'on' : 'off'} | prefs:${s.preferences ? 'on' : 'off'} | marketing:${s.marketing ? 'on' : 'off'}`;
            }
            function updateTrackerUI() {
                const dot = document.getElementById('trackDot');
                const label = document.getElementById('trackerStatus');
                const on = state.consent.marketing && state.tracker.on;
                dot.className = 'badge-dot ' + (on ? 'dot-on' : 'dot-off');
                label.textContent = 'Tracker: ' + (on ? 'ON' : 'OFF');
            }

            // ===== Participant =====
            function saveWho(e) {
                e.preventDefault();
                state.user.name = document.getElementById('name').value.trim();
                state.user.email = document.getElementById('email').value.trim();
                state.user.phone = document.getElementById('phone').value.trim();
                save(); addEvent('who_saved', { ...state.user });
                document.getElementById('whoSaved').textContent = 'Saved.';
                setTimeout(() => document.getElementById('whoSaved').textContent = '', 1500);
                // also prefill sub/phone forms
                document.getElementById('subEmail').value = state.user.email;
                document.getElementById('phoneInput').value = state.user.phone;
            }

            // ===== Email demo =====
            function subscribe(e) {
                e.preventDefault();
                const email = document.getElementById('subEmail').value.trim() || state.user.email;
                const offers = document.getElementById('offers').checked;
                if (!email) { alert('Enter an email.'); return; }
                state.inbox.unshift({ ts: now(), to: email, subject: 'Welcome (demo)', body: 'Thanks for subscribing! This message never leaves your browser.' });
                addEvent('subscribe', { email, offers });
                if (state.consent.marketing) addLeak('email_marketing', { email, offers, source: 'newsletter' });
                save(); renderInbox(); renderEmailLog();
            }
            function unsubscribe() {
                const email = document.getElementById('subEmail').value.trim() || state.user.email || '(unknown)';
                addEvent('unsubscribe', { email });
                // simulate removal — leave an event for audit
                save(); renderEmailLog();
            }

            function renderInbox() {
                const t = document.getElementById('inboxT'); t.innerHTML = '';
                for (const m of state.inbox) {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `<td class="small text-muted">${m.ts}</td><td class="mono">${escapeHtml(m.to)}</td><td>${escapeHtml(m.subject)}</td>`;
                    t.appendChild(tr);
                }
            }
            function renderEmailLog() {
                const t = document.getElementById('emailLogT'); t.innerHTML = '';
                for (const ev of state.events.filter(e => ['subscribe', 'unsubscribe'].includes(e.type))) {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `<td class="small text-muted">${ev.ts}</td><td>${ev.type}</td><td><span class="mono">${escapeHtml(JSON.stringify(ev.payload))}</span></td>`;
                    t.appendChild(tr);
                }
            }

            // ===== Phone discount =====
            function phoneDiscount(e) {
                e.preventDefault();
                const phone = document.getElementById('phoneInput').value.trim() || state.user.phone;
                const sms = document.getElementById('sms').checked;
                const ebill = document.getElementById('ebill').checked;
                const partners = document.getElementById('partners').checked;
                if (!phone) { alert('Enter a phone number.'); return; }
                state.user.phone = phone; save();
                addEvent('phone_capture', { phone, sms, ebill, partners });
                if (partners) { addLeak('partner_share', { phone, sms, ebill, partners, source: 'retail_discount' }); }
                renderPhoneLog();
                alert('Discount applied (demo). Check Leak Feed & Logs.');
            }
            function simulatePartnerLeak() {
                // Data broker style enrichment based on what we already have
                const d = { phone: state.user.phone || '(none)', email: state.user.email || '(none)', tags: ['marketing', 'targeted-ads'] };
                addLeak('data_broker', d);
                alert('Simulated leak added to feed.');
            }

            function renderLeaks() {
                const t = document.getElementById('leakT'); t.innerHTML = '';
                for (const l of state.leaks) {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `<td class="small text-muted">${l.ts}</td><td><span class="badge text-bg-warning">${l.channel}</span></td><td><span class="mono">${escapeHtml(JSON.stringify(l.data))}</span></td>`;
                    t.appendChild(tr);
                }
            }
            function renderPhoneLog() {
                const t = document.getElementById('phoneLogT'); t.innerHTML = '';
                for (const ev of state.events.filter(e => ['phone_capture'].includes(e.type))) {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `<td class="small text-muted">${ev.ts}</td><td>${ev.type}</td><td><span class="mono">${escapeHtml(JSON.stringify(ev.payload))}</span></td>`;
                    t.appendChild(tr);
                }
            }

            // ===== Scam simulator =====
            function runScams() {
                const S = new Set();
                const hasEmail = !!(state.user.email);
                const hasPhone = !!(state.user.phone);
                const marketing = !!state.consent.marketing;

                if (hasEmail) {
                    S.add(`Phishing email to ${state.user.email}: fake refund/KYC, malicious link.`);
                    if (marketing) S.add('Targeted ads profile → scammy “loan approval” banners.');
                }
                if (hasPhone) {
                    S.add(`OTP/UPI fraud call to ${state.user.phone}: “Don’t share OTP.”`);
                    S.add(`WhatsApp message to ${state.user.phone}: job/loan scam link.`);
                }
                if (state.leaks.some(l => l.channel === 'partner_share')) {
                    S.add('Telemarketing from “partners” due to consented sharing.');
                }
                if (state.leaks.some(l => l.channel === 'data_broker')) {
                    S.add('Data-broker resale: cross-site targeting & cold calls.');
                }
                S.add('If money is lost, call 1930 quickly to try freezing the transfer.');

                state.scams = Array.from(S);
                save(); renderScams(); addEvent('scam_simulated', { count: state.scams.length });
            }

            function renderScams() {
                const ul = document.getElementById('scamList'); ul.innerHTML = '';
                for (const s of state.scams) { const li = document.createElement('li'); li.textContent = s; ul.appendChild(li); }
            }

            // ===== Full event stream =====
            function renderEvents() {
                const t = document.getElementById('eventT'); t.innerHTML = '';
                for (const ev of state.events) {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `<td class="small text-muted">${ev.ts}</td><td>${ev.type}</td><td><span class="mono">${escapeHtml(JSON.stringify(ev.payload))}</span></td>`;
                    t.appendChild(tr);
                }
            }

            // ===== Export / Reset =====
            function exportJSON() {
                const blob = new Blob([JSON.stringify(state, null, 2)], { type: 'application/json' });
                const a = document.createElement('a');
                a.href = URL.createObjectURL(blob);
                a.download = `dsc-evidence-${state.sessionId}.json`;
                a.click(); URL.revokeObjectURL(a.href);
            }
            function resetAll() { localStorage.removeItem(KEY); sessionStorage.clear(); state = DEFAULT(); save(); location.reload(); }

            // ===== Helpers =====
            // function escapeHtml(s){ return s.replace(/[&<>"']/g, c=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[c])); }
            function escapeHtml(s) { s = String(s ?? ''); return s.replace(/[&<>\"']/g, c => ({ "&": "&amp;", "<": "&lt;", ">": "&gt;", "\"": "&quot;", "'": "&#39;" }[c])); }


            // ===== Language toggle (minimal EN/HI for key labels) =====
            const I18N = {
                en: {
                    sec_participant: 'Participant (demo identity)',
                    label_name: 'Name', label_email: 'Email', label_phone: 'Phone', btn_save: 'Save',
                    sec_cookies: 'Cookies & Consent', btn_accept_all: 'Accept All', btn_reject_all: 'Reject All', btn_customize: 'Customize',
                    sec_email: 'Email Subscription', label_offers: 'Send me offers & updates', hint_unsub: 'Unsubscribe any time.', btn_subscribe: 'Subscribe', btn_unsubscribe: 'Unsubscribe',
                    sec_phone: 'Phone Number for Discount', label_sms: 'Receive SMS/WhatsApp offers', label_ebill: 'Get e-bills on SMS/WhatsApp', label_partners: 'Allow sharing with "partners"', btn_get_off: 'Get ₹50 off', btn_sim_leak: 'Simulate Partner Leak',
                    sec_scam: 'Scam Scenarios (based on your data)', btn_run_scam: 'Simulate Likely Scams', btn_export: 'Export Evidence (JSON)'
                },
                hi: {
                    sec_participant: 'प्रतिभागी (डेमो पहचान)',
                    label_name: 'नाम', label_email: 'ईमेल', label_phone: 'फ़ोन', btn_save: 'सेव',
                    sec_cookies: 'कुकीज़ और सहमति', btn_accept_all: 'सब स्वीकार करें', btn_reject_all: 'सब अस्वीकार', btn_customize: 'कस्टमाइज़',
                    sec_email: 'ईमेल सदस्यता', label_offers: 'ऑफ़र/अपडेट भेजें', hint_unsub: 'कभी भी अनसब्सक्राइब करें।', btn_subscribe: 'सब्सक्राइब', btn_unsubscribe: 'अनसब्सक्राइब',
                    sec_phone: 'डिस्काउंट के लिए फ़ोन नंबर', label_sms: 'SMS/व्हाट्सऐप ऑफ़र पाएं', label_ebill: 'ई-बिल SMS/व्हाट्सऐप पर', label_partners: '"पार्टनर्स" से शेयर की अनुमति', btn_get_off: '₹50 की छूट', btn_sim_leak: 'पार्टनर लीक सिमुलेट',
                    sec_scam: 'ठगी परिदृश्य (आपके डाटा पर आधारित)', btn_run_scam: 'संभावित ठगी दिखाएं', btn_export: 'सबूत एक्सपोर्ट (JSON)'
                }
            };
            let lang = 'en';
            function applyLang() {
                const dict = I18N[lang];
                document.querySelectorAll('[data-i18n]').forEach(el => {
                    const k = el.getAttribute('data-i18n');
                    if (dict[k]) el.textContent = dict[k];
                });
                document.getElementById('langToggle').textContent = (lang === 'en' ? 'हिंदी' : 'English');
            }

            // ===== Render initial =====
            function init() {
                // navbar env
                document.getElementById('ua').textContent = navigator.userAgent;
                document.getElementById('lang').textContent = navigator.language;
                document.getElementById('tz').textContent = Intl.DateTimeFormat().resolvedOptions().timeZone;
                document.getElementById('sid').textContent = state.sessionId;

                // fill forms
                document.getElementById('name').value = state.user.name;
                document.getElementById('email').value = state.user.email;
                document.getElementById('phone').value = state.user.phone;
                document.getElementById('subEmail').value = state.user.email;
                document.getElementById('phoneInput').value = state.user.phone;

                updateConsentSummary(); updateTrackerUI();
                if (state.consent.marketing) startTracker();

                renderInbox(); renderEmailLog(); renderLeaks(); renderPhoneLog(); renderEvents(); renderScams();
                applyLang();

                // listeners
                document.getElementById('whoForm').addEventListener('submit', saveWho);
                document.getElementById('acceptAll').addEventListener('click', acceptAll);
                document.getElementById('rejectAll').addEventListener('click', rejectAll);
                document.getElementById('customize').addEventListener('click', customize);
                document.getElementById('subForm').addEventListener('submit', subscribe);
                document.getElementById('btnUnsub').addEventListener('click', unsubscribe);
                document.getElementById('phoneForm').addEventListener('submit', phoneDiscount);
                document.getElementById('btnLeak').addEventListener('click', simulatePartnerLeak);
                document.getElementById('btnScam').addEventListener('click', runScams);
                document.getElementById('btnExport').addEventListener('click', exportJSON);
                document.getElementById('resetBtn').addEventListener('click', resetAll);
                document.getElementById('langToggle').addEventListener('click', () => { lang = (lang === 'en' ? 'hi' : 'en'); applyLang(); });

                addEvent('demo_loaded', { ua: navigator.userAgent, lang: navigator.language });
            }

            document.addEventListener('DOMContentLoaded', init);
        </script>
    </body>

</html>