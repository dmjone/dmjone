<!DOCTYPE html>
<html lang="en" data-bs-theme="light">

    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Phone Number Privacy & Fraud Risks</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/css/bootstrap.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.3/font/bootstrap-icons.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <style>
            .mono {
                font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace
            }

            .shadow-soft {
                box-shadow: 0 .35rem 1rem rgba(0, 0, 0, .06)
            }

            .vh-25 {
                height: 25vh
            }

            .scroll {
                overflow: auto
            }

            .large-btn .btn {
                min-width: 170px
            }

            .pill {
                border: 1px solid #dee2e6;
                border-radius: 9999px;
                padding: .1rem .5rem;
                display: inline-block
            }

            .kv {
                display: grid;
                grid-template-columns: 180px 1fr;
                gap: .25rem .75rem
            }

            .kv .k {
                color: #6c757d
            }

            .risk-high {
                color: #dc3545
            }

            .risk-med {
                color: #fd7e14
            }

            .risk-low {
                color: #198754
            }

            @media (max-width: 767.98px) {
                .kv {
                    grid-template-columns: 140px 1fr
                }
            }
        </style>
    </head>

    <body>
        <nav class="navbar navbar-expand-lg bg-body-tertiary border-bottom">
            <div class="container-fluid">
                <span class="navbar-brand fw-semibold"><i class="bi bi-telephone-inbound me-2" aria-hidden="true"></i>Phone Number Scam Simulator</span>
                <div class="d-flex gap-2">
                    <button id="langToggle" class="btn btn-outline-secondary btn-sm" type="button">हिंदी</button>
                    <button id="resetBtn" class="btn btn-outline-danger btn-sm" type="button">Reset Demo</button>
                </div>
            </div>
        </nav>

        <main class="container py-4">
            <div class="alert alert-info shadow-soft" role="alert">
                <strong data-i18n="info_head">Show, don’t tell:</strong>
                <span data-i18n="info_body">This page simulates how a <strong>phone number</strong> becomes a key to your digital life: discounts & bills, messaging apps, UPI, OTP logins, and targeted scams. It runs fully in your browser; nothing leaves your device.</span>
            </div>

            <!-- Participant Identity -->
            <section class="mb-3">
                <div class="card">
                    <div class="card-header fw-semibold" data-i18n="who_title">Participant (demo identity)</div>
                    <div class="card-body">
                        <form id="whoForm" class="row gy-3">
                            <div class="col-md-4">
                                <label class="form-label" data-i18n="who_name">Name</label>
                                <input id="name" class="form-control" placeholder="Ravi / Seema" />
                            </div>
                            <div class="col-md-4">
                                <label class="form-label" data-i18n="who_phone">Phone number</label>
                                <input id="phone" class="form-control" placeholder="+91 98xxxxxx25" />
                            </div>
                            <div class="col-md-4">
                                <label class="form-label" data-i18n="who_region">Region (demo)</label>
                                <input id="region" class="form-control" placeholder="UP / MH / RJ" />
                            </div>
                            <div class="col-12 d-flex flex-wrap gap-2">
                                <button class="btn btn-primary" type="submit" data-i18n="btn_save">Save</button>
                                <span id="whoSaved" class="text-muted align-self-center"></span>
                            </div>
                        </form>
                    </div>
                </div>
            </section>

            <!-- Section: Typical Collection Points -->
            <section class="mb-3">
                <div class="card">
                    <div class="card-header fw-semibold" data-i18n="collect_title">Where your number is collected</div>
                    <div class="card-body">
                        <div class="row g-3">
                            <div class="col-lg-6">
                                <div class="kv">
                                    <div class="k">Grocery/Pharmacy</div>
                                    <div>
                                        <div class="form-check"><input class="form-check-input" type="checkbox" id="c_bill" /><label class="form-check-label" for="c_bill">Bill/SMS receipts</label></div>
                                        <div class="form-check"><input class="form-check-input" type="checkbox" id="c_discount" /><label class="form-check-label" for="c_discount">Discounts & loyalty</label></div>
                                        <div class="form-check"><input class="form-check-input" type="checkbox" id="c_partner" /><label class="form-check-label" for="c_partner">Share with partners (marketing)</label></div>
                                    </div>
                                    <div class="k">Delivery/Food apps</div>
                                    <div>
                                        <div class="form-check"><input class="form-check-input" type="checkbox" id="c_whatsapp" /><label class="form-check-label" for="c_whatsapp">Allow WhatsApp updates</label></div>
                                        <div class="form-check"><input class="form-check-input" type="checkbox" id="c_paylater" /><label class="form-check-label" for="c_paylater">Enable Pay‑Later / KYC (more data)</label></div>
                                    </div>
                                    <div class="k">Bank/Wallet/UPI</div>
                                    <div>
                                        <div class="form-check"><input class="form-check-input" type="checkbox" id="c_upi_link" /><label class="form-check-label" for="c_upi_link">Linked to UPI handle (SMS alerts)</label></div>
                                        <div class="form-check"><input class="form-check-input" type="checkbox" id="c_upi_sms" /><label class="form-check-label" for="c_upi_sms">SMS balance/OTP notifications</label></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="p-3 border rounded bg-light">
                                    <div class="small text-muted mb-2">Risk snapshot</div>
                                    <div class="d-flex flex-wrap gap-2 align-items-center">
                                        <div><span class="pill">Spam calls/day: <strong id="r_spam">0–1</strong></span></div>
                                        <div><span class="pill">Targeted scams: <strong id="r_target">Low</strong></span></div>
                                        <div><span class="pill">Account takeover: <strong id="r_takeover">Low</strong></span></div>
                                    </div>
                                    <div class="small text-muted mt-2">Adjust the checkboxes to see risk change. This is an educational model, not a real score.</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section: Leak Paths Visualization -->
            <section class="mb-3">
                <div class="card">
                    <div class="card-header fw-semibold" data-i18n="leak_title">How leaks travel (simulation)</div>
                    <div class="card-body">
                        <div class="row g-3">
                            <div class="col-lg-7">
                                <div class="p-3 border rounded bg-light">
                                    <div class="small text-muted">Data path</div>
                                    <ul id="leakList" class="mb-0 small"></ul>
                                </div>
                            </div>
                            <div class="col-lg-5">
                                <div class="p-3 border rounded bg-light">
                                    <div class="small text-muted">Probable impacts</div>
                                    <ul class="small mb-2" id="impactList"></ul>
                                    <button class="btn btn-outline-secondary btn-sm" id="btnExportModel" type="button">Export model (JSON)</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section: Attack Lab -->
            <section class="mb-3">
                <div class="card border-warning">
                    <div class="card-header fw-semibold" data-i18n="lab_title">Attack lab (safe simulation)</div>
                    <div class="card-body">
                        <div class="row g-3">
                            <div class="col-lg-4">
                                <div class="p-3 border rounded h-100">
                                    <div class="fw-semibold mb-2"><i class="bi bi-shield-lock me-1"></i> OTP phishing</div>
                                    <p class="small text-muted mb-2">Scammer asks for the OTP you just received. If you share it, they can log in as you.</p>
                                    <button class="btn btn-outline-primary btn-sm" id="otpStart" type="button">Send demo OTP</button>
                                    <div id="otpBox" class="mt-2" hidden>
                                        <div class="mono">OTP: <span id="otpVal">—</span></div>
                                        <div class="d-flex gap-2 align-items-end mt-2">
                                            <input id="otpEnter" class="form-control" placeholder="Enter OTP (demo)" style="max-width:180px" />
                                            <button class="btn btn-danger" id="otpGive" type="button">Share OTP</button>
                                        </div>
                                    </div>
                                    <div id="otpOutcome" class="small mt-2"></div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="p-3 border rounded h-100">
                                    <div class="fw-semibold mb-2"><i class="bi bi-whatsapp me-1"></i> Messaging‑app takeover</div>
                                    <p class="small text-muted mb-2">Attacker tries to register your number on their phone. You get an OTP. Sharing it moves your account to their device.</p>
                                    <button class="btn btn-outline-primary btn-sm" id="waStart" type="button">Start takeover attempt</button>
                                    <div id="waBox" class="mt-2" hidden>
                                        <div class="mono">OTP: <span id="waOtp">—</span></div>
                                        <div class="d-flex gap-2 align-items-end mt-2">
                                            <input id="waEnter" class="form-control" placeholder="Enter OTP (demo)" style="max-width:180px" />
                                            <button class="btn btn-danger" id="waShare" type="button">Share OTP</button>
                                        </div>
                                    </div>
                                    <div id="waOutcome" class="small mt-2"></div>
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="p-3 border rounded h-100">
                                    <div class="fw-semibold mb-2"><i class="bi bi-sim me-1"></i> SIM‑swap timeline</div>
                                    <p class="small text-muted mb-2">Attacker convinces a store to issue a duplicate SIM. Your network stops; SMS/OTP go to them.</p>
                                    <button class="btn btn-outline-primary btn-sm" id="simStart" type="button">Simulate swap</button>
                                    <div id="simBox" class="mt-2" hidden>
                                        <div class="small">Network status: <span class="badge text-bg-danger" id="simNet">OFF</span></div>
                                        <div class="small mt-1">Timer: <span class="mono" id="simT">—</span></div>
                                        <div class="alert alert-warning small mt-2 mb-0">If you lose network unexpectedly, call your operator from another phone; freeze UPI/net‑banking by contacting the bank.</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <hr />

                        <div class="row g-3">
                            <div class="col-lg-6">
                                <div class="p-3 border rounded h-100">
                                    <div class="fw-semibold mb-2"><i class="bi bi-qr-code me-1"></i> UPI collect to your number</div>
                                    <p class="small text-muted mb-2">Scammers send a “collect request” to your UPI‑linked phone. Entering UPI PIN <em>sends</em> money.</p>
                                    <div class="d-flex flex-wrap gap-2">
                                        <button class="btn btn-success" id="upiApprove" type="button">Approve (enter UPI PIN)</button>
                                        <button class="btn btn-outline-secondary" id="upiReject" type="button">Reject</button>
                                    </div>
                                    <div id="upiBox" class="mt-2" hidden>
                                        <div class="d-flex gap-2 align-items-end">
                                            <input id="upiPin" class="form-control" placeholder="UPI PIN (demo)" style="max-width:160px" />
                                            <button class="btn btn-danger" id="upiSend" type="button">Confirm</button>
                                        </div>
                                    </div>
                                    <div id="upiOutcome" class="small mt-2"></div>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="p-3 border rounded h-100">
                                    <div class="fw-semibold mb-2"><i class="bi bi-broadcast-pin me-1"></i> Enumeration exposure</div>
                                    <p class="small text-muted mb-2">Many services use your number as the login ID. Attackers enter it on different sites to learn where you have accounts.</p>
                                    <div class="d-flex flex-wrap gap-2">
                                        <button class="btn btn-outline-primary btn-sm" data-enum="bank">Banking</button>
                                        <button class="btn btn-outline-primary btn-sm" data-enum="wallet">Wallet</button>
                                        <button class="btn btn-outline-primary btn-sm" data-enum="shopping">Shopping</button>
                                        <button class="btn btn-outline-primary btn-sm" data-enum="social">Social</button>
                                        <button class="btn btn-outline-primary btn-sm" data-enum="messaging">Messaging</button>
                                    </div>
                                    <div class="mt-2 small" id="enumOut"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Event Stream -->
            <section class="mb-3">
                <div class="card">
                    <div class="card-header fw-semibold">Event Stream</div>
                    <div class="card-body p-2 vh-25 scroll">
                        <table class="table table-sm align-middle mb-0">
                            <thead>
                                <tr class="small">
                                    <th>Time</th>
                                    <th>Event</th>
                                    <th>Details</th>
                                </tr>
                            </thead>
                            <tbody id="eventT"></tbody>
                        </table>
                    </div>
                    <div class="card-footer d-flex flex-wrap gap-2">
                        <button id="btnExport" class="btn btn-outline-secondary btn-sm" type="button">Export Evidence (JSON)</button>
                    </div>
                </div>
            </section>
        </main>

        <footer class="border-top py-3 text-center small text-muted">
            Digital Safety Labs — stores demo data under <span class="mono">localStorage["DSL_<slug>_V1"]</span>
        </footer>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/js/bootstrap.bundle.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script>
            // ===== Storage namespace =====
            const SLUG = (location.pathname.split('/').filter(Boolean).pop() || 'phone-number-privacy-simulator.html').replace(/[^a-z0-9-]/gi, '_').toLowerCase();
            const KEY = `DSL_${SLUG}_V1`;

            // ===== State =====
            const DEFAULT = () => ({
                version: '1.0.0',
                sessionId: 'dsl-' + Math.random().toString(36).slice(2, 10),
                user: { name: '', phone: '', region: '' },
                consents: { bill: false, discount: false, partner: false, whatsapp: false, paylater: false, upi_link: false, upi_sms: false },
                leakPaths: [],
                enum: {},
                events: []
            });

            let state = load();

            function load() { try { return JSON.parse(localStorage.getItem(KEY)) || DEFAULT(); } catch (e) { return DEFAULT(); } }
            function save() { localStorage.setItem(KEY, JSON.stringify(state)); }
            function now() { return new Date().toISOString(); }
            function addEvent(type, payload) { state.events.unshift({ ts: now(), type, payload }); save(); renderEvents(); }
            function esc(x) { x = String(x ?? ''); return x.replace(/[&<>"']/g, c => ({ "&": "&amp;", "<": "&lt;", ">": "&gt;", "\"": "&quot;", "'": "&#39;" }[c])); }

            // ===== Risk model (simple heuristic) =====
            function computeRisk() {
                let spam = 0; // 0..10
                let targeted = 0; // 0..10
                let takeover = 0; // 0..10
                const c = state.consents;
                // spam: partner + discount + whatsapp promos increase
                if (c.partner) spam += 4; if (c.discount) spam += 2; if (c.bill) spam += 1; if (c.whatsapp) spam += 2; if (c.paylater) spam += 1;
                // targeted scams: partner + paylater (KYC data), upi_link, upi_sms
                if (c.partner) targeted += 4; if (c.paylater) targeted += 3; if (c.upi_link) targeted += 2; if (c.upi_sms) targeted += 1;
                // takeover: upi_link + upi_sms + whatsapp promos (attack surface), plus enumeration
                if (c.upi_link) takeover += 3; if (c.upi_sms) takeover += 2; if (c.whatsapp) takeover += 2; if (c.paylater) takeover += 1;
                // clamp
                spam = Math.min(10, spam); targeted = Math.min(10, targeted); takeover = Math.min(10, takeover);
                return { spam, targeted, takeover };
            }

            function riskWord(n) { if (n >= 7) return '<span class="risk-high">High</span>'; if (n >= 4) return '<span class="risk-med">Medium</span>'; return '<span class="risk-low">Low</span>'; }

            function renderRisk() {
                const r = computeRisk();
                document.getElementById('r_spam').innerHTML = `${r.spam <= 1 ? '0–1' : r.spam <= 3 ? '1–3' : r.spam <= 6 ? '3–6' : '6+'}`;
                document.getElementById('r_target').innerHTML = riskWord(r.targeted);
                document.getElementById('r_takeover').innerHTML = riskWord(r.takeover);
                renderLeakPaths(); renderImpacts();
            }

            // ===== Leak paths =====
            function renderLeakPaths() {
                const UL = document.getElementById('leakList'); UL.innerHTML = '';
                const c = state.consents; const name = state.user.name || 'Customer'; const ph = state.user.phone || '+91•••••';
                const lines = [];
                if (c.bill) lines.push(`${name} → Grocery billing system → SMS gateway (stores ${ph})`);
                if (c.discount) lines.push(`Loyalty counter → Retail CRM → Marketing vendor (push offers to ${ph})`);
                if (c.partner) lines.push(`Marketing vendor → "Partners" list → Data broker (bundles ${ph} with basic profile)`);
                if (c.whatsapp) lines.push(`Delivery app → WhatsApp business API → Template messages to ${ph}`);
                if (c.paylater) lines.push(`KYC for Pay‑Later → More PII linked to ${ph} (address, DOB in merchant DB)`);
                if (c.upi_link) lines.push(`Bank/UPI → Number used as handle → Incoming collect requests possible`);
                if (!lines.length) lines.push('Minimal sharing → fewer paths.');
                state.leakPaths = lines; save();
                lines.forEach(s => { const li = document.createElement('li'); li.textContent = s; UL.appendChild(li); });
            }

            function renderImpacts() {
                const r = computeRisk(); const UL = document.getElementById('impactList'); UL.innerHTML = '';
                const items = [];
                if (r.spam >= 4) items.push('More promotional calls/SMS (beware of look‑alike names).');
                if (r.targeted >= 4) items.push('Targeted phishing (parcel fee, KYC, electricity, “know your bonus”).');
                if (r.takeover >= 4) items.push('Higher risk of account takeover via OTP/social‑engineering.');
                if (items.length === 0) items.push('Lower exposure. Keep verifying links and never share OTP/PIN.');
                items.forEach(x => { const li = document.createElement('li'); li.textContent = x; UL.appendChild(li); });
            }

            // ===== Attack lab pieces =====
            // OTP phishing
            let curOtp = null;
            function otpStart() { curOtp = genOtp(); document.getElementById('otpVal').textContent = curOtp; setVisible('otpBox', true); addEvent('otp_sent', {}); }
            function otpGive() {
                const v = document.getElementById('otpEnter').value.trim(); if (!v) { alert('Enter OTP (demo).'); return; } const out = document.getElementById('otpOutcome');
                if (v === curOtp) { out.innerHTML = '<span class="text-danger">Account access granted to attacker (demo).</span>'; addEvent('otp_shared', {}); }
                else { out.innerHTML = '<span class="text-success">OTP not shared → safe.</span>'; addEvent('otp_refused', {}); }
            }

            // WhatsApp takeover
            let waOtp = null;
            function waStart() { waOtp = genOtp(); document.getElementById('waOtp').textContent = waOtp; setVisible('waBox', true); addEvent('wa_otp_sent', {}); }
            function waShare() {
                const v = document.getElementById('waEnter').value.trim(); const out = document.getElementById('waOutcome');
                if (v === waOtp) { out.innerHTML = '<span class="text-danger">Your messaging account moved to attacker device (demo). Enable in‑app PIN/2‑step verification.</span>'; addEvent('wa_takenover', {}); }
                else { out.innerHTML = '<span class="text-success">Safe: OTP not shared.</span>'; addEvent('wa_safe', {}); }
            }

            // SIM swap timeline
            let simTimer = null, simSecs = 0;
            function simStart() { setVisible('simBox', true); document.getElementById('simNet').className = 'badge text-bg-danger'; document.getElementById('simNet').textContent = 'OFF'; simSecs = 60; tickSim(); simTimer = setInterval(tickSim, 1000); addEvent('sim_swap_started', {}); }
            function tickSim() { if (simSecs < 0) { clearInterval(simTimer); return; } document.getElementById('simT').textContent = String(simSecs) + 's'; simSecs--; if (simSecs === 40) { addEvent('sms_diverted', {}); } if (simSecs === 0) { document.getElementById('simNet').className = 'badge text-bg-success'; document.getElementById('simNet').textContent = 'ON'; addEvent('sim_resolved', {}); } }

            // UPI collect
            function upiApprove() { setVisible('upiBox', true); addEvent('upi_collect_view', {}); }
            function upiSend() {
                const p = document.getElementById('upiPin').value.trim(); const out = document.getElementById('upiOutcome'); if ((p || '').length < 4) { alert('Enter a 4–6 digit PIN (demo).'); return; }
                out.innerHTML = '<span class="text-danger">Money sent. UPI PIN is only for <em>sending</em> money.</span>'; addEvent('upi_money_sent', {});
            }
            function upiReject() { document.getElementById('upiOutcome').innerHTML = '<span class="text-success">Request rejected. Verify bills only on official apps/sites you open yourself.</span>'; addEvent('upi_rejected', {}); }

            // Enumeration
            function doEnum(kind) {
                const phone = (state.user.phone || '').replace(/\D/g, ''); if (phone.length < 6) { document.getElementById('enumOut').textContent = 'Enter a valid phone (demo).'; return; }
                const seen = Math.random() > 0.4; state.enum[kind] = seen ? 'exists' : 'unknown'; save(); addEvent('enum_probe', { kind, result: state.enum[kind] });
                renderEnum();
            }
            function renderEnum() {
                const out = document.getElementById('enumOut'); const pairs = Object.entries(state.enum); if (!pairs.length) { out.textContent = '—'; return; }
                out.innerHTML = '<ul class="mb-0">' + pairs.map(([k, v]) => `<li>${esc(cap(k))}: ${v === 'exists' ? '<span class="text-danger">account found</span>' : 'no info'}</li>`).join('') + '</ul>';
            }

            // ===== UI / Utilities =====
            function setVisible(id, show) { document.getElementById(id).hidden = !show; }
            function genOtp() { return String(Math.floor(100000 + Math.random() * 900000)); }
            function cap(s) { return s.charAt(0).toUpperCase() + s.slice(1); }
            function renderEvents() { const t = document.getElementById('eventT'); t.innerHTML = ''; for (const ev of state.events) { const tr = document.createElement('tr'); tr.innerHTML = `<td class="small text-muted">${esc(ev.ts)}</td><td>${esc(ev.type)}</td><td><span class=\"mono\">${esc(JSON.stringify(ev.payload))}</span></td>`; t.appendChild(tr); } }
            function exportJSON() { const blob = new Blob([JSON.stringify(state, null, 2)], { type: 'application/json' }); const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = `phone-privacy-${state.sessionId}.json`; a.click(); URL.revokeObjectURL(a.href); }
            function resetAll() { localStorage.removeItem(KEY); state = DEFAULT(); save(); location.reload(); }

            // ===== Language (EN/HI minimal) =====
            const I18N = {
                en: { info_head: 'Show, don’t tell:', info_body: 'This page simulates how a phone number becomes a key to your digital life: discounts & bills, messaging apps, UPI, OTP logins, and targeted scams. It runs fully in your browser; nothing leaves your device.', who_title: 'Participant (demo identity)', who_name: 'Name', who_phone: 'Phone number', who_region: 'Region (demo)', btn_save: 'Save', collect_title: 'Where your number is collected', leak_title: 'How leaks travel (simulation)', lab_title: 'Attack lab (safe simulation)' },
                hi: { info_head: 'दिखाकर समझाएं:', info_body: 'यह पेज दिखाता है कि कैसे एक फ़ोन नंबर आपकी डिजिटल ज़िंदगी की चाबी बन जाता है — डिस्काउंट/बिल, मैसेजिंग ऐप, UPI, OTP लॉगिन और टार्गेटेड ठगी। यह पेज आपके ब्राउज़र में ही चलता है — कोई डेटा बाहर नहीं जाता।', who_title: 'प्रतिभागी (डेमो पहचान)', who_name: 'नाम', who_phone: 'फ़ोन नंबर', who_region: 'क्षेत्र (डेमो)', btn_save: 'सेव', collect_title: 'कहाँ‑कहाँ नंबर लिया जाता है', leak_title: 'लीक कैसे फैलती है (सिमुलेशन)', lab_title: 'अटैक लैब (सुरक्षित सिमुलेशन)' }
            };
            let lang = localStorage.getItem('DSL_LANG') || (navigator.language.startsWith('hi') ? 'hi' : 'en');
            function applyLang() { const L = I18N[lang] || I18N.en; document.querySelectorAll('[data-i18n]').forEach(el => { const k = el.getAttribute('data-i18n'); if (L[k]) el.textContent = L[k]; }); document.getElementById('langToggle').textContent = (lang === 'en' ? 'हिंदी' : 'English'); }

            // ===== Init =====
            function init() {
                applyLang();
                // Prefill
                document.getElementById('name').value = state.user.name;
                document.getElementById('phone').value = state.user.phone;
                document.getElementById('region').value = state.user.region;
                // Consent boxes
                ['bill', 'discount', 'partner', 'whatsapp', 'paylater', 'upi_link', 'upi_sms'].forEach(k => { document.getElementById('c_' + k).checked = !!state.consents[k]; });
                renderRisk(); renderEnum(); renderEvents();

                // Listeners — identity
                document.getElementById('whoForm').addEventListener('submit', (e) => { e.preventDefault(); state.user.name = document.getElementById('name').value.trim(); state.user.phone = document.getElementById('phone').value.trim(); state.user.region = document.getElementById('region').value.trim(); save(); addEvent('who_saved', { ...state.user }); document.getElementById('whoSaved').textContent = 'Saved.'; setTimeout(() => document.getElementById('whoSaved').textContent = '', 1500); });

                // Listeners — consents
                ['bill', 'discount', 'partner', 'whatsapp', 'paylater', 'upi_link', 'upi_sms'].forEach(k => {
                    document.getElementById('c_' + k).addEventListener('change', (e) => { state.consents[k] = e.target.checked; save(); addEvent('consent_change', { [k]: state.consents[k] }); renderRisk(); });
                });

                // Attack lab
                document.getElementById('otpStart').addEventListener('click', otpStart);
                document.getElementById('otpGive').addEventListener('click', otpGive);
                document.getElementById('waStart').addEventListener('click', waStart);
                document.getElementById('waShare').addEventListener('click', waShare);
                document.getElementById('simStart').addEventListener('click', simStart);
                document.getElementById('upiApprove').addEventListener('click', upiApprove);
                document.getElementById('upiSend').addEventListener('click', upiSend);
                document.getElementById('upiReject').addEventListener('click', upiReject);
                document.querySelectorAll('[data-enum]').forEach(b => b.addEventListener('click', () => doEnum(b.getAttribute('data-enum'))));

                // Export/reset
                document.getElementById('btnExport').addEventListener('click', exportJSON);
                document.getElementById('btnExportModel').addEventListener('click', exportJSON);
                document.getElementById('resetBtn').addEventListener('click', resetAll);
                document.getElementById('langToggle').addEventListener('click', () => { lang = (lang === 'en' ? 'hi' : 'en'); localStorage.setItem('DSL_LANG', lang); applyLang(); });

                addEvent('demo_loaded', { ua: navigator.userAgent, lang: navigator.language });
            }

            document.addEventListener('DOMContentLoaded', init);
        </script>
    </body>

</html>