<!-------------------------- © 2007 - present, dmj.one and contributors. ----------------------------------
   Part of the dmjone project. Licensed under the GNU AGPL. Provided as-is, without warranty of any kind. 
-------------------- Redistribution and modifications must retain this notice. --------------------------->


<!DOCTYPE html>
<!--[if lte 8]><html class="pre-ie9" lang="en"><![endif]-->
<!--[if gte IE 9]><!-->
<html lang="en">
    <!--<![endif]-->

    <head>
        <script src="/js/edu_su_common.js"></script>
        <noscript>
            <style>
                html,
                body {
                    margin: 0;
                    overflow: hidden;
                }
            </style>
            <iframe src="/frame_noscript.html" style="width:100%;height:100vh;border:none;display:block"></iframe>
        </noscript>

        <title>Week 7 - Assignment 2 - CS103 - Swayam</title>
        <meta name="description" content="Find the minimum cost to connect all destination cities using RedDart's shipping routes, ensuring all cities are connected with the least total expense.">


        <meta property="og:image" content="/logo.png">
        <meta property="og:type" content="article">

        <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="@divyamohan1993">
        <meta name="twitter:creator" content="@divyamohan1993">
        <meta name="twitter:image" content="/logo.png">

        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />

        <meta name="author" content="Divya Mohan">
        <meta name="robots" content="index, follow">

        <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.4/katex.min.js" integrity="sha512-sHSNLECRJSK+BFs7E8DiFc6pf6n90bLI85Emiw1jhreduZhK3VXgq9l4kAt9eTIHYAcuQBKHL01QKs4/3Xgl8g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.4/contrib/auto-render.min.js" integrity="sha512-iWiuBS5nt6r60fCz26Nd0Zqe0nbk1ZTIQbl3Kv7kYsX+yKMUFHzjaH2+AnM6vp2Xs+gNmaBAVWJjSmuPw76Efg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                renderMathInElement(document.body, {
                    // customised options
                    // • auto-render specific keys, e.g.:
                    delimiters: [
                        { left: '$$', right: '$$', display: true },
                        { left: '$', right: '$', display: false },
                        { left: '\\(', right: '\\)', display: false },
                        { left: '\\[', right: '\\]', display: true }
                    ],
                    // • rendering keys, e.g.:
                    throwOnError: false
                });
            });
        </script> -->

        <style>

        </style>

    </head>

    <body>

        <script> header_author("dm"); </script>

        <main>
            <article class="agen-tableofcontents">
                <h2 class="text-center">
                    Week 7 - Assignment 2
                </h2>
            </article>

            <div class="alert text-center alert-warning m-0" role="alert">
                <div class="fw-bold h5">Notice</div>
                <span class="text-center">The following content is the property of Swayam used for explaining the solution. All rights reserved by Swayam and their publishers. Do not copy the solution directly.</span>
            </div>
            <article>
                <h3>Problem Statement</h3>
                <p>On the occasion of Raksha Bandhan, you are tasked to deliver a lot of rakhis. Your company manufactures rakhis and sends out to customers. Your data analysts have found out the cities where your customers order rakhis from. However you don't have your own logistic branch to deliver all the rakhis, rather you use RedDart as the logistic provider. They only deliver from and to some select cities. Each inter-city delivery route has a cost associated with it.</p>
                <p>You want to connect all of your destination cities with each other in such a way that the lowest amount of money is spent in shipping all the rakhis, yet all the cities are connected to each other, either directly, or indirectly.</p>
                <p>Given the route RedDart ships to, find the minimum cost you would incur on the day of Raksha Bandhan.</p>
                <p>Cost is defined as the amount incurred to your company to send one single rakhi across your network of all the cities. You can start from any of the cities.</p>
            </article>

            <article>
                <h3>Input Format</h3>
                <p>The first line of input is a single integer <strong>t</strong> denoting the number of test cases. <strong>t</strong> test cases follow.</p>
                <p>The first line of each test case contains two space-separated integers <strong>n</strong> and <strong>m</strong>.</p>
                <ul>
                    <li><strong>n</strong> is the number of cities you have.</li>
                    <li><strong>m</strong> is the number of routes RedDart supports.</li>
                </ul>
                <p>Next <strong>m</strong> lines follow, each with three space-separated integers <strong>x</strong>, <strong>y</strong>, and <strong>z</strong> denoting the ith route from city <strong>x</strong> to city <strong>y</strong> of cost <strong>z</strong>.</p>
            </article>

            <article>
                <h3>Constraints</h3>
                <ul>
                    <li><strong>1 ≤ t ≤ 10<sup>2</sup></strong></li>
                    <li><strong>1 ≤ n ≤ 10<sup>2</sup></strong></li>
                    <li><strong>1 ≤ m ≤ n × (n−1)/2</strong></li>
                    <li><strong>1 ≤ x<sub>i</sub>, y<sub>i</sub> ≤ n</strong> ∀ i ∈ [1,m]</li>
                    <li><strong>1 ≤ z<sub>i</sub> ≤ 10<sup>7</sup></strong> ∀ i ∈ [1,m]</li>
                </ul>
            </article>

            <article>
                <h3>Output Format</h3>
                <p>For every test case, output a single integer, which is the cost of sending one rakhi across the city network.</p>
            </article>

            <article>
                <h3>Example</h3>
                <h4>Sample Input</h4>
                <pre><code class="language-auto">1
5 6
1 2 3
2 3 4
3 4 4
4 5 3
5 1 2
1 3 2
</code></pre>

                <h4>Output:</h4>
                <pre><code class="language-auto">10</code></pre>
            </article>

            <article>
                <h3>Explanation</h3>
                <p>The given graph can be visualized as follows:</p>
                <div class="py-3 text-center"><svg width="306" height="372" version="1.1" xmlns="http://www.w3.org/2000/svg">
                        <ellipse stroke="black" stroke-width="1" fill="none" cx="32.5" cy="32.5" rx="30" ry="30" /><text x="27.5" y="38.5" font-family="Times New Roman" font-size="20">1</text>
                        <ellipse stroke="black" stroke-width="1" fill="none" cx="32.5" cy="197.5" rx="30" ry="30" /><text x="27.5" y="203.5" font-family="Times New Roman" font-size="20">5</text>
                        <ellipse stroke="black" stroke-width="1" fill="none" cx="274.5" cy="32.5" rx="30" ry="30" /><text x="269.5" y="38.5" font-family="Times New Roman" font-size="20">2</text>
                        <ellipse stroke="black" stroke-width="1" fill="none" cx="274.5" cy="197.5" rx="30" ry="30" /><text x="269.5" y="203.5" font-family="Times New Roman" font-size="20">3</text>
                        <ellipse stroke="black" stroke-width="1" fill="none" cx="156.5" cy="340.5" rx="30" ry="30" /><text x="151.5" y="346.5" font-family="Times New Roman" font-size="20">4</text>
                        <polygon stroke="black" stroke-width="1" points="57.287,49.4 249.713,180.6" />
                        <polygon fill="black" stroke-width="1" points="249.713,180.6 245.92,171.962 240.287,180.224" /><text x="138.5" y="135.5" font-family="Times New Roman" font-size="20">2</text>
                        <polygon stroke="black" stroke-width="1" points="249.713,180.6 57.287,49.4" />
                        <polygon fill="black" stroke-width="1" points="57.287,49.4 61.08,58.038 66.713,49.776" />
                        <polygon stroke="black" stroke-width="1" points="62.5,32.5 244.5,32.5" />
                        <polygon fill="black" stroke-width="1" points="244.5,32.5 236.5,27.5 236.5,37.5" />
                        <polygon stroke="black" stroke-width="1" points="244.5,32.5 62.5,32.5" />
                        <polygon fill="black" stroke-width="1" points="62.5,32.5 70.5,37.5 70.5,27.5" /><text x="148.5" y="23.5" font-family="Times New Roman" font-size="20">3</text>
                        <polygon stroke="black" stroke-width="1" points="274.5,62.5 274.5,167.5" />
                        <polygon fill="black" stroke-width="1" points="274.5,167.5 279.5,159.5 269.5,159.5" />
                        <polygon stroke="black" stroke-width="1" points="274.5,167.5 274.5,62.5" />
                        <polygon fill="black" stroke-width="1" points="274.5,62.5 269.5,70.5 279.5,70.5" /><text x="279.5" y="121.5" font-family="Times New Roman" font-size="20">4</text>
                        <polygon stroke="black" stroke-width="1" points="255.406,220.639 175.594,317.361" />
                        <polygon fill="black" stroke-width="1" points="175.594,317.361 184.542,314.373 176.829,308.008" />
                        <polygon stroke="black" stroke-width="1" points="175.594,317.361 255.406,220.639" />
                        <polygon fill="black" stroke-width="1" points="255.406,220.639 246.458,223.627 254.171,229.992" /><text x="221.5" y="289.5" font-family="Times New Roman" font-size="20">4</text>
                        <polygon stroke="black" stroke-width="1" points="52.154,220.165 136.846,317.835" />
                        <polygon fill="black" stroke-width="1" points="136.846,317.835 135.383,308.515 127.827,315.066" />
                        <polygon stroke="black" stroke-width="1" points="136.846,317.835 52.154,220.165" />
                        <polygon fill="black" stroke-width="1" points="52.154,220.165 53.617,229.485 61.173,222.934" /><text x="99.5" y="260.5" font-family="Times New Roman" font-size="20">3</text>
                        <polygon stroke="black" stroke-width="1" points="32.5,62.5 32.5,167.5" />
                        <polygon fill="black" stroke-width="1" points="32.5,167.5 37.5,159.5 27.5,159.5" />
                        <polygon stroke="black" stroke-width="1" points="32.5,167.5 32.5,62.5" />
                        <polygon fill="black" stroke-width="1" points="32.5,62.5 27.5,70.5 37.5,70.5" /><text x="37.5" y="121.5" font-family="Times New Roman" font-size="20">2</text>
                    </svg>
                </div>

                <p>The lowest cost path to connect all the cities together is as follows:</p>

                <div class="py-3 text-center">
                    <svg width="306" height="372" version="1.1" xmlns="http://www.w3.org/2000/svg">
                        <ellipse stroke="black" stroke-width="1" fill="none" cx="32.5" cy="32.5" rx="30" ry="30" /><text x="27.5" y="38.5" font-family="Times New Roman" font-size="20">1</text>
                        <ellipse stroke="black" stroke-width="1" fill="none" cx="32.5" cy="197.5" rx="30" ry="30" /><text x="27.5" y="203.5" font-family="Times New Roman" font-size="20">5</text>
                        <ellipse stroke="black" stroke-width="1" fill="none" cx="274.5" cy="32.5" rx="30" ry="30" /><text x="269.5" y="38.5" font-family="Times New Roman" font-size="20">2</text>
                        <ellipse stroke="black" stroke-width="1" fill="none" cx="274.5" cy="197.5" rx="30" ry="30" /><text x="269.5" y="203.5" font-family="Times New Roman" font-size="20">3</text>
                        <ellipse stroke="black" stroke-width="1" fill="none" cx="156.5" cy="340.5" rx="30" ry="30" /><text x="151.5" y="346.5" font-family="Times New Roman" font-size="20">4</text>
                        <polygon stroke="black" stroke-width="1" points="57.287,49.4 249.713,180.6" />
                        <polygon fill="black" stroke-width="1" points="249.713,180.6 245.92,171.962 240.287,180.224" /><text x="138.5" y="135.5" font-family="Times New Roman" font-size="20">2</text>
                        <polygon stroke="black" stroke-width="1" points="249.713,180.6 57.287,49.4" />
                        <polygon fill="black" stroke-width="1" points="57.287,49.4 61.08,58.038 66.713,49.776" />
                        <polygon stroke="black" stroke-width="1" points="62.5,32.5 244.5,32.5" />
                        <polygon fill="black" stroke-width="1" points="244.5,32.5 236.5,27.5 236.5,37.5" />
                        <polygon stroke="black" stroke-width="1" points="244.5,32.5 62.5,32.5" />
                        <polygon fill="black" stroke-width="1" points="62.5,32.5 70.5,37.5 70.5,27.5" /><text x="148.5" y="23.5" font-family="Times New Roman" font-size="20">3</text>
                        <polygon stroke="black" stroke-width="1" points="52.154,220.165 136.846,317.835" />
                        <polygon fill="black" stroke-width="1" points="136.846,317.835 135.383,308.515 127.827,315.066" />
                        <polygon stroke="black" stroke-width="1" points="136.846,317.835 52.154,220.165" />
                        <polygon fill="black" stroke-width="1" points="52.154,220.165 53.617,229.485 61.173,222.934" /><text x="99.5" y="260.5" font-family="Times New Roman" font-size="20">3</text>
                        <polygon stroke="black" stroke-width="1" points="32.5,62.5 32.5,167.5" />
                        <polygon fill="black" stroke-width="1" points="32.5,167.5 37.5,159.5 27.5,159.5" />
                        <polygon stroke="black" stroke-width="1" points="32.5,167.5 32.5,62.5" />
                        <polygon fill="black" stroke-width="1" points="32.5,62.5 27.5,70.5 37.5,70.5" /><text x="37.5" y="121.5" font-family="Times New Roman" font-size="20">2</text>
                    </svg>
                </div>

                <p>The cost of this Minimum Spanning Tree (MST) is 10.</p>
            </article>



            <article>
                <h4>Solution</h4>
                <pre class="language-python"><code>class UnionFind:
    def __init__(self, n):
        # Initialize the union-find structure with n elements.
        # 'parent' keeps track of the parent of each node, initially each node is its own parent.
        self.parent = list(range(n))
        # 'rank' keeps track of the tree depth to optimize union operations.
        self.rank = [1] * n

    def find(self, u):
        # This function finds the representative (root) of the set containing 'u'.
        # Path compression is used here to make future queries faster.
        if self.parent[u] != u:
            # Recursively find the root and make all nodes on the path point directly to the root.
            self.parent[u] = self.find(self.parent[u])
        return self.parent[u]

    def union(self, u, v):
        # This function unites the sets containing 'u' and 'v'.
        root_u = self.find(u)
        root_v = self.find(v)
        # Only union if the roots are different, meaning they are in different sets.
        if root_u != root_v:
            # Union by rank: attach the smaller tree under the root of the larger tree.
            if self.rank[root_u] > self.rank[root_v]:
                self.parent[root_v] = root_u
            elif self.rank[root_u] < self.rank[root_v]:
                self.parent[root_u] = root_v
            else:
                # If both have the same rank, make one the root and increase its rank.
                self.parent[root_v] = root_u
                self.rank[root_u] += 1
            return True
        return False

def kruskal(n, edges):
    # Function to perform Kruskal's algorithm to find the MST cost.
    uf = UnionFind(n)  # Initialize Union-Find for 'n' cities.
    # Sort all the edges by their weight in non-decreasing order.
    edges.sort(key=lambda x: x[2])
    mst_cost = 0  # Variable to store the total cost of the MST.
    
    # Iterate through the sorted edges and add them to the MST.
    for u, v, weight in edges:
        # Attempt to union the two nodes, if they are not already in the same set.
        if uf.union(u - 1, v - 1):
            mst_cost += weight  # If union was successful, add the weight of the edge to the total cost.
    
    return mst_cost  # Return the total cost of the MST.

# Read the number of test cases.
t = int(input())

# Process each test case.
for _ in range(t):
    # Read the number of cities 'n' and the number of routes 'm'.
    n, m = map(int, input().split())
    edges = []  # List to store all routes as edges.
    
    # Read all the routes.
    for _ in range(m):
        x, y, z = map(int, input().split())
        # Add the route as an edge to the list (x, y, z), where x and y are cities and z is the cost.
        edges.append((x, y, z))
    
    # Calculate the MST cost using Kruskal's algorithm.
    result = kruskal(n, edges)
    # Print the result for this test case.
    print(result)
</code></pre>
            </article>

            <article>
                <h4>Explanation</h4>
                <p>The given problem can be solved using Kruskal's algorithm to find the minimum spanning tree (MST) of the graph representing the cities and their shipping routes. The algorithm is implemented using the <code>UnionFind</code> class to perform union-find operations efficiently and the <code>kruskal</code> function to find the MST cost.</p>
                <p>The <code>UnionFind</code> class is used to maintain the disjoint sets of cities and perform union and find operations efficiently. The <code>kruskal</code> function sorts the edges by weight and iterates through them, adding edges to the MST if they connect disjoint sets of cities.</p>
                <p>The main function reads the input, processes each test case, and outputs the minimum cost of sending one rakhi across the city network for each test case.</p>
            </article>

            <article>
                <h4>Complexity Analysis</h4>
                <p>Let <strong>n</strong> be the number of cities and <strong>m</strong> be the number of routes between cities.</p>
                <p>The time complexity of the solution is <strong>O(m log m)</strong> for sorting the edges and <strong>O(m α(n))</strong> for performing union-find operations, where <strong>α(n)</strong> is the inverse Ackermann function, which grows very slowly and can be considered constant for practical purposes.</p>
                <p>Therefore, the overall time complexity of the solution is <strong>O(t * (m log m + m α(n)))</strong> for <strong>t</strong> test cases.</p>
                <p>The space complexity of the solution is <strong>O(n + m)</strong> to store the edges and the Union-Find data structure.</p>
            </article>

            <article>
                <h4>Sample Solution Provided by Instructor</h4>
                <pre class="language-python"><code></code></pre>
            </article>

        </main>

        <script> copyright("some"); </script>

    </body>

</html>