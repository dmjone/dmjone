<!-------------------------- © 2007 - present, dmj.one and contributors. ----------------------------------
   Part of the dmjone project. Licensed under the GNU AGPL. Provided as-is, without warranty of any kind. 
-------------------- Redistribution and modifications must retain this notice. --------------------------->


<!DOCTYPE html>
<!--[if lte 8]><html class="pre-ie9" lang="en"><![endif]-->
<!--[if gte IE 9]><!-->
<html lang="en">
    <!--<![endif]-->

    <head>
        <script src="/js/edu_su_common.js"></script>
        <noscript>
            <style>
                html,
                body {
                    margin: 0;
                    overflow: hidden;
                }
            </style>
            <iframe src="/frame_noscript.html" style="width:100%;height:100vh;border:none;display:block"></iframe>
        </noscript>

        <title>Week 6 - Assignment 2 - CS103 - Swayam</title>


        <meta property="og:image" content="/logo.png">
        <meta property="og:type" content="article">

        <meta name="twitter:card" content="summary">
        <meta name="twitter:site" content="@divyamohan1993">
        <meta name="twitter:creator" content="@divyamohan1993">
        <meta name="twitter:image" content="/logo.png">

        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />

        <meta name="author" content="Divya Mohan">
        <meta name="robots" content="index, follow">

        <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.4/katex.min.js" integrity="sha512-sHSNLECRJSK+BFs7E8DiFc6pf6n90bLI85Emiw1jhreduZhK3VXgq9l4kAt9eTIHYAcuQBKHL01QKs4/3Xgl8g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.4/contrib/auto-render.min.js" integrity="sha512-iWiuBS5nt6r60fCz26Nd0Zqe0nbk1ZTIQbl3Kv7kYsX+yKMUFHzjaH2+AnM6vp2Xs+gNmaBAVWJjSmuPw76Efg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                renderMathInElement(document.body, {
                    // customised options
                    // • auto-render specific keys, e.g.:
                    delimiters: [
                        { left: '$$', right: '$$', display: true },
                        { left: '$', right: '$', display: false },
                        { left: '\\(', right: '\\)', display: false },
                        { left: '\\[', right: '\\]', display: true }
                    ],
                    // • rendering keys, e.g.:
                    throwOnError: false
                });
            });
        </script> -->

        <style>

        </style>

    </head>

    <body>

        <script> header_author("dm"); </script>

        <main>
            <article class="agen-tableofcontents">
                <h2 class="text-center">
                    Week 6 - Assignment 2
                </h2>
            </article>

            <div class="alert text-center alert-warning m-0" role="alert">
                <div class="fw-bold h5">Notice</div>
                <span class="text-center">The following content is the property of Swayam used for explaining the solution. All rights reserved by Swayam and their publishers. Do not copy the solution directly.</span>
            </div>
            <article>
                <h3>Problem</h3>
                <p>You have recently joined the HR department of a mid-size startup in Bangalore. The startup operates smoothly through the coordinated efforts of multiple departments such as Sales, Marketing, Tech, Accounts, etc. all under the same roof. Communication between these various departments is a crucial task that must be handled by the HR department.</p>
                <p>You are provided with details about the communication pathways between departments. If department <strong>i</strong> and department <strong>j</strong> need to communicate for a meeting or collaboration, department <strong>i</strong> can directly reach out to department <strong>j</strong> to set it up, or vice versa. In doing so, a certain amount of time, <strong>t</strong> time units, is expended in the communication process. However, due to the hierarchical structure of communication between departments, not all departments can communicate directly with each other. Sometimes, department <strong>i</strong> may have to communicate with department <strong>j</strong> via several intermediary departments. In these cases, the time taken for communication increases as the messages pass through each department in the chain, adding up the time units and causing delays.</p>
                <p>To ensure efficient communication, the HR department decides to implement a <strong>time_cutoff</strong> to analyze the time spent on inter-departmental communication. If the time required for communication between two departments exceeds (strictly greater than) the <strong>time_cutoff</strong> it is not considered when evaluating which department is the best at communicating with others. The department deemed best at communication is the one that, within the <strong>time_cutoff</strong>, can communicate with the most other departments, with the fewest time units spent.</p>
                <p><strong>Note:</strong> Give priority to connections with most departments first, then fewest time units, then department number.</p>
            </article>

            <article>
                <h4>Input</h4>
                <p>The first line of input contains one integer <strong>t</strong>, the number of test cases.</p>
                <p>The input of each testcase is as follows:</p>
                <p>The first line contains three space-separated integers, <strong>n</strong>, <strong>m</strong>, and <strong>time_cutoff</strong> where <strong>n</strong> is the number of departments at your company and <strong>m</strong> is the number of direct communications between these departments.</p>
                <p>The next <strong>m</strong> lines each contain three space-separated integers <strong>i</strong>, <strong>j</strong>, and <strong>t</strong> where <strong>i</strong> and <strong>j</strong> are the department numbers and <strong>t</strong> is the time taken for direct communication between these departments.</p>
            </article>

            <article>
                <h4>Constraints</h4>
                <ul>
                    <li>1 ≤ <strong>t</strong> ≤ 50</li>
                    <li>2 ≤ <strong>n</strong> ≤ 100</li>
                    <li>0 ≤ <strong>i</strong>, <strong>j</strong> ≤ n-1</li>
                    <li>1 ≤ <strong>m</strong> ≤ n*(n-1)/2</li>
                    <li>1 ≤ <strong>t</strong>, <strong>time_cutoff</strong> ≤ 10<sup>4</sup></li>
                </ul>
            </article>

            <article>
                <h4>Output</h4>
                <p>For each test case, print one integer, the department number which can communicate with the most departments within the <strong>time_cutoff</strong> and in the fewest time units spent. In case of a tie, return the department with the higher department number.</p>
            </article>

            <article>
                <h4>Example</h4>
                <p><strong>Input:</strong></p>
                <pre><code class="">2
4 4 4
0 1 3
1 2 1
1 3 4
2 3 1
4 4 5
0 1 1
1 2 4
2 3 1
0 3 3
    </code></pre>
                <p><strong>Output:</strong></p>
                <pre><code class="">2
3
    </code></pre>
            </article>

            <article>
                <h5>Explanation</h5>
                <p>For testcase 1, the below-stated diagram is the department connection structure. When analyzing the best department, department 1 has communication with 3 other departments within the time cutoff so does department 2. They both equally spend 6 total time units in doing so. To break the tie we return the department with the higher department number which is department 2.</p>
                <div class="text-center py-3">
                    <svg width="287" height="278" version="1.1" xmlns="http://www.w3.org/2000/svg">
                        <ellipse stroke="black" stroke-width="1" fill="none" cx="32.5" cy="32.5" rx="30" ry="30" /><text x="27.5" y="38.5" font-family="Times New Roman" font-size="20">3</text>
                        <ellipse stroke="black" stroke-width="1" fill="none" cx="75.5" cy="219.5" rx="30" ry="30" /><text x="70.5" y="225.5" font-family="Times New Roman" font-size="20">2</text>
                        <ellipse stroke="black" stroke-width="1" fill="none" cx="203.5" cy="90.5" rx="30" ry="30" /><text x="198.5" y="96.5" font-family="Times New Roman" font-size="20">1</text>
                        <ellipse stroke="black" stroke-width="1" fill="none" cx="255.5" cy="246.5" rx="30" ry="30" /><text x="250.5" y="252.5" font-family="Times New Roman" font-size="20">0</text>
                        <polygon stroke="black" stroke-width="1" points="60.91,42.136 175.09,80.864" />
                        <polygon fill="black" stroke-width="1" points="175.09,80.864 169.12,73.559 165.908,83.029" /><text x="104.5" y="82.5" font-family="Times New Roman" font-size="20">4</text>
                        <polygon stroke="black" stroke-width="1" points="175.09,80.864 60.91,42.136" />
                        <polygon fill="black" stroke-width="1" points="60.91,42.136 66.88,49.441 70.092,39.971" />
                        <polygon stroke="black" stroke-width="1" points="212.987,118.96 246.013,218.04" />
                        <polygon fill="black" stroke-width="1" points="246.013,218.04 248.227,208.869 238.74,212.031" /><text x="211.5" y="181.5" font-family="Times New Roman" font-size="20">3</text>
                        <polygon stroke="black" stroke-width="1" points="246.013,218.04 212.987,118.96" />
                        <polygon fill="black" stroke-width="1" points="212.987,118.96 210.773,128.131 220.26,124.969" />
                        <polygon stroke="black" stroke-width="1" points="96.631,198.204 182.369,111.796" />
                        <polygon fill="black" stroke-width="1" points="182.369,111.796 173.185,113.953 180.284,120.996" /><text x="144.5" y="175.5" font-family="Times New Roman" font-size="20">1</text>
                        <polygon stroke="black" stroke-width="1" points="182.369,111.796 96.631,198.204" />
                        <polygon fill="black" stroke-width="1" points="96.631,198.204 105.815,196.047 98.716,189.004" />
                        <polygon stroke="black" stroke-width="1" points="39.223,61.737 68.777,190.263" />
                        <polygon fill="black" stroke-width="1" points="68.777,190.263 71.857,181.346 62.111,183.587" /><text x="36.5" y="135.5" font-family="Times New Roman" font-size="20">1</text>
                        <polygon stroke="black" stroke-width="1" points="68.777,190.263 39.223,61.737" />
                        <polygon fill="black" stroke-width="1" points="39.223,61.737 36.143,70.654 45.889,68.413" />
                    </svg>
                </div>
                <p>For testcase 2, the below-stated diagram is the department connection structure. When analyzing the best department, all departments can communicate with all other departments within the time cutoff. Department 0 and 3 have the least total time of communication of 8 units of time. To break the tie we return the department with the higher department number which is department 3.</p>
                <div class="text-center py-3">
                    <svg width="306" height="297" version="1.1" xmlns="http://www.w3.org/2000/svg">
                        <ellipse stroke="black" stroke-width="1" fill="none" cx="149.5" cy="32.5" rx="30" ry="30" /><text x="144.5" y="38.5" font-family="Times New Roman" font-size="20">0</text>
                        <ellipse stroke="black" stroke-width="1" fill="none" cx="149.5" cy="265.5" rx="30" ry="30" /><text x="144.5" y="271.5" font-family="Times New Roman" font-size="20">2</text>
                        <ellipse stroke="black" stroke-width="1" fill="none" cx="32.5" cy="150.5" rx="30" ry="30" /><text x="27.5" y="156.5" font-family="Times New Roman" font-size="20">3</text>
                        <ellipse stroke="black" stroke-width="1" fill="none" cx="274.5" cy="150.5" rx="30" ry="30" /><text x="269.5" y="156.5" font-family="Times New Roman" font-size="20">1</text>
                        <polygon stroke="black" stroke-width="1" points="171.578,245.188 252.422,170.812" />
                        <polygon fill="black" stroke-width="1" points="252.422,170.812 243.149,172.548 249.92,179.908" /><text x="217.5" y="228.5" font-family="Times New Roman" font-size="20">4</text>
                        <polygon stroke="black" stroke-width="1" points="171.315,53.094 252.685,129.906" />
                        <polygon fill="black" stroke-width="1" points="252.685,129.906 250.3,120.779 243.435,128.051" /><text x="196.5" y="112.5" font-family="Times New Roman" font-size="20">1</text>
                        <polygon stroke="black" stroke-width="1" points="252.685,129.906 171.315,53.094" />
                        <polygon fill="black" stroke-width="1" points="171.315,53.094 173.7,62.221 180.565,54.949" />
                        <polygon stroke="black" stroke-width="1" points="252.422,170.812 171.578,245.188" />
                        <polygon fill="black" stroke-width="1" points="171.578,245.188 180.851,243.452 174.08,236.092" />
                        <polygon stroke="black" stroke-width="1" points="53.895,171.53 128.105,244.47" />
                        <polygon fill="black" stroke-width="1" points="128.105,244.47 125.904,235.297 118.894,242.428" /><text x="75.5" y="228.5" font-family="Times New Roman" font-size="20">1</text>
                        <polygon stroke="black" stroke-width="1" points="128.105,244.47 53.895,171.53" />
                        <polygon fill="black" stroke-width="1" points="53.895,171.53 56.096,180.703 63.106,173.572" />
                        <polygon stroke="black" stroke-width="1" points="53.623,129.197 128.377,53.803" />
                        <polygon fill="black" stroke-width="1" points="128.377,53.803 119.194,55.964 126.295,63.005" /><text x="96.5" y="112.5" font-family="Times New Roman" font-size="20">3</text>
                        <polygon stroke="black" stroke-width="1" points="128.377,53.803 53.623,129.197" />
                        <polygon fill="black" stroke-width="1" points="53.623,129.197 62.806,127.036 55.705,119.995" />
                    </svg>
                </div>
            </article>


            <article>
                <h4>Solution</h4>
                <pre class="language-python"><code>import heapq  # Importing the heapq module to use the priority queue (min-heap)
from collections import defaultdict  # Importing defaultdict for easy dictionary creation

# Function to implement Dijkstra's algorithm for finding the shortest paths
def dijkstra(n, graph, start, time_cutoff):
    # Initialize distance dictionary with infinity for all nodes
    dist = {i: float('inf') for i in range(n)}
    dist[start] = 0  # Distance to the start node is 0
    
    # Initialize the priority queue with the start node
    heap = [(0, start)]
    
    while heap:  # While there are nodes to process
        current_dist, node = heapq.heappop(heap)  # Get the node with the smallest distance
        
        # If this distance is already larger than the known distance, skip it
        if current_dist > dist[node]:
            continue
        
        # Explore neighbors of the current node
        for neighbor, time in graph[node]:
            distance = current_dist + time  # Calculate new distance to neighbor
            if distance < dist[neighbor]:  # If the new distance is shorter
                dist[neighbor] = distance  # Update the shortest distance
                heapq.heappush(heap, (distance, neighbor))  # Add the neighbor to the heap
    
    # Calculate how many nodes are reachable within the time_cutoff
    reachable = 0
    total_time = 0
    for d in dist.values():
        if d <= time_cutoff:  # Only consider nodes within the time_cutoff
            reachable += 1
            total_time += d  # Sum the total time spent communicating
    
    return reachable, total_time  # Return the number of reachable nodes and total communication time

# Function to find the best department for communication
def find_best_department(n, m, time_cutoff, connections):
    # Create an adjacency list to represent the graph
    graph = defaultdict(list)
    for i, j, t in connections:
        graph[i].append((j, t))  # Add edge from i to j with time t
        graph[j].append((i, t))  # Add edge from j to i with time t (because the graph is undirected)
    
    best_department = -1  # Initialize the best department
    max_reachable = -1  # Initialize the max number of reachable departments
    min_time = float('inf')  # Initialize the minimum time spent
    
    # Check each department to see if it is the best for communication
    for department in range(n):
        reachable, total_time = dijkstra(n, graph, department, time_cutoff)  # Run Dijkstra's algorithm
        
        # Update the best department based on the problem's criteria
        if (reachable > max_reachable) or \
           (reachable == max_reachable and total_time < min_time) or \
           (reachable == max_reachable and total_time == min_time and department > best_department):
            best_department = department  # Update to the current department
            max_reachable = reachable  # Update the max number of reachable departments
            min_time = total_time  # Update the minimum time spent
    
    return best_department  # Return the best department

# Main function to handle input and output
def main():
    t = int(input().strip())  # Read the number of test cases
    results = []  # List to store results for each test case
    for _ in range(t):
        n, m, time_cutoff = map(int, input().strip().split())  # Read n, m, and time_cutoff
        connections = []
        for _ in range(m):
            i, j, t = map(int, input().strip().split())  # Read each connection
            connections.append((i, j, t))  # Store the connection
        result = find_best_department(n, m, time_cutoff, connections)  # Find the best department
        results.append(result)  # Store the result
    
    for result in results:  # Output all results
        print(result)

if __name__ == "__main__":
    main()  # Run the main function when the script is executed
</code></pre>
            </article>

            <article>
                <h4>Explanation</h4>
                <p>The given problem can be solved using Dijkstra's algorithm to find the shortest paths from a source node to all other nodes in the graph. The algorithm is implemented in the <code>dijkstra</code> function, which takes the number of nodes, the graph representation, the starting node, and the time cutoff as input. It returns the number of reachable nodes within the time cutoff and the total time spent communicating with them.</p>
                <p>The <code>find_best_department</code> function creates an adjacency list representation of the graph based on the input connections. It then iterates over each department to find the best department for communication. The best department is determined based on the number of reachable departments, the total time spent communicating, and the department number in case of a tie.</p>
                <p>The main function reads the input, processes each test case, and outputs the best department for communication in each case.</p>
            </article>

            <article>
                <h4>Complexity Analysis</h4>
                <p>Let <strong>n</strong> be the number of departments and <strong>m</strong> be the number of direct communications between departments.</p>
                <p>The time complexity of the Dijkstra's algorithm implementation is <strong>O(n log n + m)</strong> for each test case. The <code>find_best_department</code> function iterates over all departments, running Dijkstra's algorithm for each, resulting in a total time complexity of <strong>O(n<sup>2</sup> log n + n*m)</strong> for each test case.</p>
                <p>Therefore, the overall time complexity of the solution is <strong>O(t * (n<sup>2</sup> log n + n*m))</strong> for <strong>t</strong> test cases.</p>
                <p>The space complexity of the solution is <strong>O(n + m)</strong> to store the graph representation and the results for each test case.</p>
            </article>

            <article>
                <h4>Sample Solution Provided by Instructor</h4>
                <pre class="language-python"><code></code></pre>
            </article>


        </main>

        <script> copyright("all"); </script>

    </body>

</html>