const API_URL = "https://dmj.one/api/attendance/?view_history=true&download_history_csv=true"; async function loadAttendance() { try { const t = await fetch(API_URL); if (!t.ok) throw new Error(t.status + " " + t.statusText); const e = (await t.text()).trim().split(/\r?\n/).filter((t => t)), [n, ...a] = e, d = n.split(","), c = document.querySelector("thead"), s = document.createElement("tr"); d.forEach(((t, e) => { const n = document.createElement("th"); n.textContent = t, e < 2 && (n.style.minWidth = "140px"), s.appendChild(n) })), c.appendChild(s); const o = document.querySelector("tbody"); a.forEach((t => { const e = t.split(","), n = document.createElement("tr"); e.forEach(((t, e) => { const a = document.createElement("td"); if (e >= 2) { const e = document.createElement("span"); e.classList.add("badge"), e.textContent = t || "", "P" === t ? e.classList.add("bg-success") : "A" === t ? e.classList.add("bg-danger") : e.classList.add("bg-secondary"), a.appendChild(e) } else a.textContent = t; n.appendChild(a) })), o.appendChild(n) })), document.getElementById("loading").style.display = "none", document.getElementById("table-container").style.display = "block" } catch (t) { document.getElementById("loading").innerHTML = `<div class="alert alert-danger">Error loading data: ${t.message}</div>` } } loadAttendance();